(()=>{"use strict";var t={25:(t,e,n)=>{n.d(e,{A:()=>o});var a=n(601),s=n.n(a),i=n(314),r=n.n(i)()(s());r.push([t.id,".gRWi6ZNPxSNeUTksBkc_{min-height:100vh;min-width:100vw}",""]),r.locals={page:"gRWi6ZNPxSNeUTksBkc_"};const o=r},730:(t,e,n)=>{n.d(e,{A:()=>o});var a=n(601),s=n.n(a),i=n(314),r=n.n(i)()(s());r.push([t.id,'.XUf85rV91neffhmTH7lj{display:grid;grid-template-columns:repeat(4, 1fr);grid-template-rows:repeat(5, 1fr);grid-template-areas:"btnsRow     btnsRow  btnsRow  btnsRow" "carName     carName  carName  carName" "btnsColoumn carImage carImage carImage" "btnsColoumn carImage carImage carImage" "btnsColoumn carImage carImage carImage";max-height:100%;max-width:fit-content}.XUf85rV91neffhmTH7lj .QizypQwmhIDjoiuYRWMx{position:relative;grid-area:carImage}.XUf85rV91neffhmTH7lj .QizypQwmhIDjoiuYRWMx .OBJaQ6yNWr0aJH9KQyQB{max-width:80px;max-height:100%}.XUf85rV91neffhmTH7lj .VKuSHxJ2GfTOKhKWNrIu{grid-area:btnsRow;display:flex;gap:2px}.XUf85rV91neffhmTH7lj .VKuSHxJ2GfTOKhKWNrIu input{height:15px;padding:0;font-size:.7rem}.XUf85rV91neffhmTH7lj .yHu1GmN84ZbImJGG932z{grid-area:btnsColoumn;display:flex;flex-direction:column;justify-content:space-around}.XUf85rV91neffhmTH7lj .yHu1GmN84ZbImJGG932z input{height:15px;width:40px;padding:0;font-size:.7rem}.XUf85rV91neffhmTH7lj .CqWO6q7kECCFdqVnYu4d{grid-area:carName;padding-top:3px;padding-left:10px;text-align:center;font-size:1rem}',""]),r.locals={carWrap:"XUf85rV91neffhmTH7lj",carImageWrap:"QizypQwmhIDjoiuYRWMx",carImage:"OBJaQ6yNWr0aJH9KQyQB",btnsRow:"VKuSHxJ2GfTOKhKWNrIu",engineBtns:"yHu1GmN84ZbImJGG932z",carName:"CqWO6q7kECCFdqVnYu4d"};const o=r},933:(t,e,n)=>{n.d(e,{A:()=>o});var a=n(601),s=n.n(a),i=n(314),r=n.n(i)()(s());r.push([t.id,".RoX_7tfaZ5f3nQndNC2f{display:flex;align-items:center;height:25px;gap:2px}.RoX_7tfaZ5f3nQndNC2f .tYRQnlgTeglptUl6VD7x{height:100%;max-width:120px}.RoX_7tfaZ5f3nQndNC2f .wVGTBmur6TjVbENiYT9g{height:100%}",""]),r.locals={formCar:"RoX_7tfaZ5f3nQndNC2f",textInput:"tYRQnlgTeglptUl6VD7x",colorInput:"wVGTBmur6TjVbENiYT9g"};const o=r},702:(t,e,n)=>{n.d(e,{A:()=>o});var a=n(601),s=n.n(a),i=n(314),r=n.n(i)()(s());r.push([t.id,".EZ2dXpYOoJS5j_7tjECh{display:flex;flex-direction:column;gap:2px;max-width:fit-content}.EZ2dXpYOoJS5j_7tjECh .aK0cUJKcZwK5lf7nHqfq{display:flex;min-width:100%}.EZ2dXpYOoJS5j_7tjECh .aK0cUJKcZwK5lf7nHqfq input{flex-grow:1}",""]),r.locals={controlPanel:"EZ2dXpYOoJS5j_7tjECh",btnsRow:"aK0cUJKcZwK5lf7nHqfq"};const o=r},269:(t,e,n)=>{n.d(e,{A:()=>o});var a=n(601),s=n.n(a),i=n(314),r=n.n(i)()(s());r.push([t.id,".dqN1sqn1MxbaNnkuWxSX{display:flex;flex-direction:column;padding:10px}.dqN1sqn1MxbaNnkuWxSX .DpHdoyQ1CN_OSoEB6WdQ{padding-bottom:5px}.Ob4MB3siZPnIW2yAzCZn{position:relative;width:100%;height:80px;margin:10px 0;border-bottom:10px dashed #fff}.Ob4MB3siZPnIW2yAzCZn .G3ReeQktTZXjTgqcuuyD{position:absolute;top:0;right:100px;height:50px}.wgPwLfbSF27ixvU3quni{position:fixed;display:flex;justify-content:center;align-items:center;height:100vh;width:100vw;color:#970707;background-color:rgba(0,0,0,.5647058824)}.wgPwLfbSF27ixvU3quni p{padding:15px;font-size:2rem;font-weight:800;border:2px solid #970707;background-color:#000}",""]),r.locals={garage:"dqN1sqn1MxbaNnkuWxSX",btnsRow:"DpHdoyQ1CN_OSoEB6WdQ",track:"Ob4MB3siZPnIW2yAzCZn",flag:"G3ReeQktTZXjTgqcuuyD",greeting:"wgPwLfbSF27ixvU3quni"};const o=r},697:(t,e,n)=>{n.d(e,{A:()=>o});var a=n(601),s=n.n(a),i=n(314),r=n.n(i)()(s());r.push([t.id,".OjRQfgII7KQ4kxUHT1b7{max-width:500px;border-collapse:collapse;border:3px solid #f5f5f5}.OjRQfgII7KQ4kxUHT1b7 .W2uSrw7FNLWAu4jwM9uD{max-height:60px;border:1px solid #f5f5f5;border-bottom:3px solid #f5f5f5;font-size:1.5rem}.OjRQfgII7KQ4kxUHT1b7 .jem4yNyudNJkMvEJ5OZp{text-align:center;max-height:50px;border:1px solid #f5f5f5}.eEEzN7DyDmwkDNacoxIA{display:flex;max-width:70px;max-height:40px}.eEEzN7DyDmwkDNacoxIA span,.eEEzN7DyDmwkDNacoxIA input{display:none}",""]),r.locals={table:"OjRQfgII7KQ4kxUHT1b7",head:"W2uSrw7FNLWAu4jwM9uD",cell:"jem4yNyudNJkMvEJ5OZp",car:"eEEzN7DyDmwkDNacoxIA"};const o=r},361:(t,e,n)=>{n.d(e,{A:()=>o});var a=n(601),s=n.n(a),i=n(314),r=n.n(i)()(s());r.push([t.id,'.ZiuTaRDIH4KdJ1CxClEg{display:flex;flex-direction:column}[data-sortable]{cursor:pointer}[data-sortable]:hover{color:#75c1ff}[data-order=asc] span::after{color:#75c1ff;content:"↑"}[data-order=desc] span::after{color:#75c1ff;content:"↓"}',""]),r.locals={winners:"ZiuTaRDIH4KdJ1CxClEg"};const o=r},695:(t,e,n)=>{n.d(e,{A:()=>o});var a=n(601),s=n.n(a),i=n(314),r=n.n(i)()(s());r.push([t.id,".cOwPEmal6rpCMrg8YeSg{width:80px;height:25px}.cOwPEmal6rpCMrg8YeSg:hover{scale:1.1;cursor:pointer}.cOwPEmal6rpCMrg8YeSg:disabled{opacity:.6;cursor:default}",""]),r.locals={button:"cOwPEmal6rpCMrg8YeSg"};const o=r},378:(t,e,n)=>{n.d(e,{A:()=>o});var a=n(601),s=n.n(a),i=n(314),r=n.n(i)()(s());r.push([t.id,"*{box-sizing:border-box}body{margin:0;color:#ddd;background-color:#1d0f0f}",""]);const o=r},245:(t,e,n)=>{n.d(e,{A:()=>o});var a=n(601),s=n.n(a),i=n(314),r=n.n(i)()(s());r.push([t.id,"html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}h1{font-size:2em;margin:.67em 0}dl dl,dl ol,dl ul,ol dl,ul dl{margin:0}ol ol,ol ul,ul ol,ul ul{margin:0}hr{box-sizing:content-box;color:inherit;height:0;overflow:visible}main{display:block}pre{font-family:monospace,monospace;font-size:1em}a{background-color:rgba(0,0,0,0)}abbr[title]{text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}img{border-style:none}svg:not(:root){overflow:hidden}table{border-color:inherit;text-indent:0}button,input,select{margin:0}button{overflow:visible;text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button}fieldset{padding:.35em .75em .625em}input{overflow:visible}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;white-space:normal}progress{display:inline-block;vertical-align:baseline}select{text-transform:none}textarea{margin:0;overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}::-moz-focus-inner{border-style:none;padding:0}:-moz-focusring{outline:1px dotted ButtonText}:-moz-ui-invalid{box-shadow:none}details{display:block}dialog{background-color:#fff;border:solid;color:#000;display:block;height:-moz-fit-content;height:-webkit-fit-content;height:fit-content;left:0;margin:auto;padding:1em;position:absolute;right:0;width:-moz-fit-content;width:-webkit-fit-content;width:fit-content}dialog:not([open]){display:none}summary{display:list-item}canvas{display:inline-block}template{display:none}[hidden]{display:none}",""]);const o=r},76:(t,e,n)=>{n.d(e,{A:()=>o});var a=n(601),s=n.n(a),i=n(314),r=n.n(i)()(s());r.push([t.id,".XCbsGr7u5lKYZ3ae3sDS{height:90vh;width:100%}div .zZhDgs1rWgdfOyc_EFBn{display:none}",""]),r.locals={container:"XCbsGr7u5lKYZ3ae3sDS",hidden:"zZhDgs1rWgdfOyc_EFBn"};const o=r},314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",a=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),a&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),a&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,a,s,i){"string"==typeof t&&(t=[[null,t,void 0]]);var r={};if(a)for(var o=0;o<this.length;o++){var c=this[o][0];null!=c&&(r[c]=!0)}for(var l=0;l<t.length;l++){var d=[].concat(t[l]);a&&r[d[0]]||(void 0!==i&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=i),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),s&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=s):d[4]="".concat(s)),e.push(d))}},e}},601:t=>{t.exports=function(t){return t[1]}},72:t=>{var e=[];function n(t){for(var n=-1,a=0;a<e.length;a++)if(e[a].identifier===t){n=a;break}return n}function a(t,a){for(var i={},r=[],o=0;o<t.length;o++){var c=t[o],l=a.base?c[0]+a.base:c[0],d=i[l]||0,h="".concat(l," ").concat(d);i[l]=d+1;var p=n(h),u={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==p)e[p].references++,e[p].updater(u);else{var m=s(u,a);a.byIndex=o,e.splice(o,0,{identifier:h,updater:m,references:1})}r.push(h)}return r}function s(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,s){var i=a(t=t||[],s=s||{});return function(t){t=t||[];for(var r=0;r<i.length;r++){var o=n(i[r]);e[o].references--}for(var c=a(t,s),l=0;l<i.length;l++){var d=n(i[l]);0===e[d].references&&(e[d].updater(),e.splice(d,1))}i=c}}},659:t=>{var e={};t.exports=function(t,n){var a=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(n)}},540:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},56:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},825:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var a="";n.supports&&(a+="@supports (".concat(n.supports,") {")),n.media&&(a+="@media ".concat(n.media," {"));var s=void 0!==n.layer;s&&(a+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),a+=n.css,s&&(a+="}"),n.media&&(a+="}"),n.supports&&(a+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleTagTransform(a,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},113:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function n(a){var s=e[a];if(void 0!==s)return s.exports;var i=e[a]={id:a,exports:{}};return t[a](i,i.exports,n),i.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var a=e.getElementsByTagName("script");if(a.length)for(var s=a.length-1;s>-1&&(!t||!/^http(s?):/.test(t));)t=a[s--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),n.nc=void 0,(()=>{var t=n(72),e=n.n(t),a=n(825),s=n.n(a),i=n(659),r=n.n(i),o=n(56),c=n.n(o),l=n(540),d=n.n(l),h=n(113),p=n.n(h),u=n(695),m={};m.styleTagTransform=p(),m.setAttributes=c(),m.insert=r().bind(null,"head"),m.domAPI=s(),m.insertStyleElement=d(),e()(u.A,m);const f=u.A&&u.A.locals?u.A.locals:void 0;class b extends HTMLInputElement{constructor(t="button",e="button"){super(),this.className=f.button,this.type=e,this.value=t}}function g(t="div",e,n,...a){const s=document.createElement(t);return s.classList.add(...e??[]),n&&Object.entries(n).forEach((([t,e])=>{s.setAttribute(t,e)})),s.append(...a),s}customElements.define("custom-btn",b,{extends:"input"});var v=n(76),w={};w.styleTagTransform=p(),w.setAttributes=c(),w.insert=r().bind(null,"head"),w.domAPI=s(),w.insertStyleElement=d(),e()(v.A,w);const y=v.A&&v.A.locals?v.A.locals:void 0;class x{constructor(t){this.btnNextPage=new b("NEXT"),this.btnPreviousPage=new b("PREV"),this.numberPage=g("p"),this.page=1,this.element=g("div",[y.container,...t??[]]),this.btnNextPage.addEventListener("click",(()=>this.nextPage())),this.btnPreviousPage.addEventListener("click",(()=>this.prevPage()))}hidde(){this.element.classList.add(y.hidden)}shows(){this.element.classList.remove(y.hidden)}nextPage(){this.page+=1,this.viewContent()}prevPage(){this.page-=1,this.viewContent()}async viewContent(){this.btnNextPage.disabled=!0,this.btnPreviousPage.disabled=!0,this.numberPage.innerText=`Page#${this.page}`}}function E(t){const e=new FormData(t),n={};return e.forEach(((t,e)=>{n[e]=t})),n}const A=n.p+"icons/sprite.40d68806bfd4cb9f2c2e.svg";var T=n(730),P={};P.styleTagTransform=p(),P.setAttributes=c(),P.insert=r().bind(null,"head"),P.domAPI=s(),P.insertStyleElement=d(),e()(T.A,P);const C=T.A&&T.A.locals?T.A.locals:void 0;class I extends HTMLElement{constructor(t){super(),this.carInfo=t,this.selectBtn=new b("SELECT"),this.removeBtn=new b("REMOVE"),this.startBtn=new b("Start"),this.stopBtn=new b("Stop"),this.carImageWrap=g("div",[C.carImageWrap]),this.time=0,this.progress=0,this.distance=0,this.className=C.carWrap,this.carImageWrap.innerHTML=`<svg class=${C.carImage} fill=${t.color} stroke=#ffffff stroke-width=2><use xlink:href=${A}#93123_car></use></svg>`;const e=g("span",[C.carName]);e.textContent=t.name,this.append(this.carImageWrap,e);const n=g("div",[C.btnsRow]);n.append(this.selectBtn,this.removeBtn),this.prepend(n);const a=g("div",[C.engineBtns]);this.startBtn.name="startEngine",this.stopBtn.disabled=!0,this.stopBtn.name="stopEngine",a.append(this.startBtn,this.stopBtn),this.append(a);const s=()=>this.carImageWrap.offsetParent?this.carImageWrap.offsetParent.clientWidth-this.offsetWidth:0;setTimeout((()=>{this.distance=s()}),0),window.addEventListener("resize",(()=>{this.distance=s(),this.setTranslate()})),this.removeBtn.addEventListener("click",(()=>{this.dataset.removed="true"})),this.selectBtn.addEventListener("click",(()=>{this.dataset.selected="true"})),this.startBtn.addEventListener("click",(()=>this.startEngine())),this.stopBtn.addEventListener("click",(()=>this.stop()))}async startEngine(){try{this.startBtn.disabled=!0;const t=await fetch(`http://127.0.0.1:3000/engine?id=${this.carInfo.id}&status=started`,{method:"PATCH"});this.stopBtn.disabled=!1;const{distance:e,velocity:n}=await t.json();return this.time=e/n,await new Promise((t=>{this.drive().then((()=>t(this))).catch((t=>{console.warn(t.message)}))}))}catch(t){return this.startBtn.disabled=!1,await new Promise(((e,n)=>{n(t)}))}}animation(t){const e=performance.now(),n=a=>{let s=(a-e)/t;s>=1&&(s=1,this.dataset.finished="true"),this.progress=s,this.setTranslate(),s<1&&(this.animationID=requestAnimationFrame(n))};requestAnimationFrame(n)}async drive(){this.animation(this.time);const t=await fetch(`http://127.0.0.1:3000/engine?id=${this.carInfo.id}&status=drive`,{method:"PATCH"});if(500===t.status&&this.animationID)throw cancelAnimationFrame(this.animationID),new Error(`Engine trouble: ${this.carInfo.name} is stopped`);404===t.status&&this.stop()}async stop(){try{this.stopBtn.disabled=!0,this.removeAttribute("data-finished"),(await fetch(`http://127.0.0.1:3000/engine?id=${this.carInfo.id}&status=stopped`,{method:"PATCH"})).ok&&this.animationID&&(this.startBtn.disabled=!1,cancelAnimationFrame(this.animationID),this.progress=0,this.setTranslate())}catch{console.warn("Server is not available!")}}setTranslate(){this.carImageWrap.style.setProperty("transform",`translateX(${this.distance*this.progress}px`)}}customElements.define("custom-car",I);var N=n(933),S={};S.styleTagTransform=p(),S.setAttributes=c(),S.insert=r().bind(null,"head"),S.domAPI=s(),S.insertStyleElement=d(),e()(N.A,S);const k=N.A&&N.A.locals?N.A.locals:void 0;class B extends HTMLFormElement{constructor(t){super(),this.character=t,this.textInput=g("input",[k.textInput],{type:"text",name:"name"}),this.colorInput=g("input",[k.colorInput],{type:"color",name:"color",value:"#aaaaaa"}),this.idPseudoInput=g("input",[],{type:"hidden",name:"id"}),this.btnSubmit=new b("","submit"),this.className=k.formCar,this.method="POST",this.btnSubmit.value=t.toUpperCase(),this.btnSubmit.disabled=!0,this.textInput.required=!0,"update"===t&&[this.textInput,this.colorInput].forEach((t=>{t.setAttribute("disabled","true")})),this.append(this.textInput,this.colorInput,this.idPseudoInput,this.btnSubmit),this.textInput.addEventListener("input",(()=>{this.btnSubmit.disabled=!this.checkValidity()}))}fill(t){this.textInput.value=t.name,this.colorInput.value=t.color,[this.textInput,this.colorInput,this.btnSubmit].forEach((t=>{t.removeAttribute("disabled")}))}reset(){super.reset(),"update"===this.character&&[this.textInput,this.colorInput,this.btnSubmit].forEach((t=>{t.setAttribute("disabled","true")}))}}customElements.define("custom-form",B,{extends:"form"});var R=n(702),W={};W.styleTagTransform=p(),W.setAttributes=c(),W.insert=r().bind(null,"head"),W.domAPI=s(),W.insertStyleElement=d(),e()(R.A,W);const j=R.A&&R.A.locals?R.A.locals:void 0;class O extends HTMLElement{constructor(){super(),this.createForm=new B("create"),this.updateForm=new B("update"),this.raceBtn=new b("RACE","button"),this.resetBtn=new b("RESET","button"),this.generateBtn=new b("GENERATE","button"),this.className=j.controlPanel,this.resetBtn.disabled=!0,this.append(this.createForm,this.updateForm,g("div",[j.btnsRow],{},this.raceBtn,this.resetBtn,this.generateBtn))}}customElements.define("control-panel",O);var H=n(269),M={};M.styleTagTransform=p(),M.setAttributes=c(),M.insert=r().bind(null,"head"),M.domAPI=s(),M.insertStyleElement=d(),e()(H.A,M);const D=H.A&&H.A.locals?H.A.locals:void 0,L=n.p+"icons/BSicon_RACE.3cfce2ef4ec5dcfbbcd5.svg";class z extends x{constructor(){super([D.garage]),this.totalNuberofCars=g("p"),this.controlPanel=new O,this.isRaceReset=!1;const t=g("div",[D.statistics],{},this.totalNuberofCars,this.numberPage);this.element.append(this.controlPanel,t,g("div",[D.btnsRow],{},this.btnPreviousPage,this.btnNextPage)),this.viewContent(),this.init()}async viewContent(){super.viewContent();try{const t=await fetch(`http://127.0.0.1:3000/garage?_page=${this.page}&_limit=${z.limitOfCarsOnPage}`),e=t.headers.get("X-Total-Count");this.totalNuberofCars.textContent=`Garage (${e})`;const n=await t.json();document.querySelectorAll(`.${D.track}`).forEach((t=>t.remove())),n.forEach((t=>{this.createTrack(t)})),this.btnNextPage.disabled=!(this.page<Number(e)/z.limitOfCarsOnPage),this.btnPreviousPage.disabled=1===this.page}catch(t){console.warn("Server is not available!")}}createTrack(t){const e=new I(t);this.element.append(g("div",[D.track],{},e,g("img",[D.flag],{src:L,alt:"finish"}))),new MutationObserver((n=>{switch(n[0].attributeName){case"data-removed":this.removeCar(t.id);break;case"data-selected":this.controlPanel.updateForm.fill(t),this.controlPanel.updateForm.idPseudoInput.value=`${t.id}`;break;case"disabled":n[0].target===e.startBtn&&(this.controlPanel.raceBtn.disabled=this.stateRaceBtn()),n[0].target===e.stopBtn&&(this.controlPanel.resetBtn.disabled=this.stateResetBtn())}})).observe(e,{attributes:!0,subtree:!0,attributeFilter:["data-removed","data-selected","disabled"]})}init(){this.controlPanel.createForm.addEventListener("submit",(t=>{t.preventDefault();const e=E(this.controlPanel.createForm);this.addCar(e),this.controlPanel.createForm.reset()})),this.controlPanel.updateForm.addEventListener("submit",(t=>{t.preventDefault();const e=E(this.controlPanel.updateForm);this.updateCar(e),this.controlPanel.updateForm.reset()})),this.controlPanel.generateBtn.addEventListener("click",(()=>{this.addCar(...function(t=1){const e=["Toyota","Mercedes-Benz","BMW","Audi","Ford","Chevrolet","Honda","Hyundai","Volkswagen","Nissan","Kalymaga","Koryto"],n=["Corolla","E-Class","3 Series","A4","Mustang","Camaro","Civic","Elantra","Golf","Altima","Vedro","Klyacha"],a=[];for(let s=0;s<t;s+=1){const t={name:`${e[Math.floor(Math.random()*e.length)]} ${n[Math.floor(Math.random()*n.length)]}`,color:`#${Math.floor(16777216*Math.random()).toString(16)}`};a.push(t)}return a}(100))})),this.controlPanel.raceBtn.addEventListener("click",(()=>this.startRace())),this.controlPanel.resetBtn.addEventListener("click",(()=>this.resetRace())),[this.btnNextPage,this.btnPreviousPage].forEach((t=>{t.addEventListener("click",(async()=>{this.isRaceReset||this.resetRace()}))}))}async addCar(...t){t.forEach((async t=>{try{await fetch("http://127.0.0.1:3000/garage",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({name:t.name,color:t.color})})}catch(t){console.warn("Server is not available!")}})),this.viewContent()}async updateCar(t){try{await fetch(`http://127.0.0.1:3000/garage/${t.id}`,{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify({name:t.name,color:t.color})})}catch(t){console.warn("Server is not available!")}this.viewContent()}async removeCar(t){try{await fetch(`http://127.0.0.1:3000/garage/${t}`,{method:"DELETE"}),await fetch(`http://127.0.0.1:3000/winners/${t}`,{method:"DELETE"})}catch(t){console.warn("Server is not available!")}this.viewContent()}async startRace(){this.isRaceReset=!1;const t=this.element.getElementsByTagName("custom-car"),e=Object.values(t).map((t=>t.startEngine()));Promise.any(e).then((t=>{const e=t;if(!this.isRaceReset&&e.dataset.finished){const t=g("p");t.textContent=`${e.carInfo.name} won the race [${(e.time/1e3).toFixed(2)}s]`;const n=g("div",[D.greeting],{},t);this.element.append(n),n.addEventListener("click",(()=>n.remove())),e.dispatchEvent(new CustomEvent("race",{bubbles:!0,detail:{id:e.carInfo.id,time:e.time}}))}})).catch((t=>console.warn(t)))}resetRace(){this.isRaceReset=!0;const t=this.element.getElementsByTagName("custom-car");Object.values(t).forEach((t=>{t instanceof I&&t.stop()}))}stateRaceBtn(){const t=this.element.querySelectorAll("[name=startEngine]");return!Object.values(t).every((t=>!t.disabled))}stateResetBtn(){const t=this.element.querySelectorAll("[name=stopEngine]");return!Object.values(t).some((t=>!t.disabled))}}z.limitOfCarsOnPage=7;const F=z;var $=n(697),Q={};Q.styleTagTransform=p(),Q.setAttributes=c(),Q.insert=r().bind(null,"head"),Q.domAPI=s(),Q.insertStyleElement=d(),e()($.A,Q);const Z=$.A&&$.A.locals?$.A.locals:void 0;class q extends HTMLTableElement{constructor(){super(),this.className=Z.table,this.createTHead(),this.createTBody();const t=["Number","Car","Name","Wins","Best time (sec)"].map((t=>{const e=g("span");e.textContent=t;const n=g("th",[Z.head],{},e);return"Wins"===t&&(n.dataset.sortable="wins"),"Best time (sec)"===t&&(n.dataset.sortable="time"),n}));this.tHead?.append(g("tr",[],{},...t))}async addRow(t,e){try{const n=await fetch(`http://127.0.0.1:3000/garage/${t.id}`),a=await n.json(),s=[e+1,new I(a),a.name,t.wins,t.time].map((t=>{const e=g("td",[Z.cell]);return t instanceof I?(e.append(t),t.classList.add(Z.car)):e.textContent=t,e}));this.tBodies?.item(0)?.append(g("tr",[],{},...s))}catch{console.warn("Server is not avialable")}}clearTable(){const t=this.tBodies?.item(0)?.getElementsByTagName("tr");t&&Object.values(t).forEach((t=>t.remove()))}}customElements.define("custom-table",q,{extends:"table"});var G=n(361),K={};K.styleTagTransform=p(),K.setAttributes=c(),K.insert=r().bind(null,"head"),K.domAPI=s(),K.insertStyleElement=d(),e()(G.A,K);const J=G.A&&G.A.locals?G.A.locals:void 0;class U extends x{constructor(){super([J.winners]),this.recordsTable=new q,this.totalNuberofWinns=g("p"),this.sortParams={sort:"id",order:"ASC"};const t=g("div",[J.statistics],{},this.totalNuberofWinns,this.numberPage);this.element.append(t,g("div",[],{},this.btnPreviousPage,this.btnNextPage),this.recordsTable),this.init()}init(){document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll("[data-sortable]").forEach(((t,e,n)=>{t.addEventListener("click",(t=>{n.forEach((t=>t.removeAttribute("data-order")));const e=t.currentTarget;this.sortParams?.sort===e.dataset.sortable?"ASC"===this.sortParams?.order?(this.sortParams.order="DESC",e.dataset.order="desc"):this.sortParams={sort:"id",order:"ASC"}:(this.sortParams={sort:e.dataset.sortable,order:"ASC"},e.dataset.order="asc"),this.viewContent()}))}))}))}async viewContent(){try{super.viewContent(),this.recordsTable.clearTable();let t=`http://127.0.0.1:3000/winners?_page=${this.page}&_limit=${U.limitOfWinnersToPage}`;t+=`&_sort=${this.sortParams.sort}&_order=${this.sortParams.order}`;const e=await fetch(t),n=e.headers.get("X-Total-Count");this.totalNuberofWinns.textContent=`Winners (${n})`,(await e.json()).forEach(((t,e)=>{this.recordsTable.addRow(t,e+10*(this.page-1))})),this.btnNextPage.disabled=!(this.page<Number(n)/U.limitOfWinnersToPage),this.btnPreviousPage.disabled=1===this.page}catch{console.warn("Server is not available!")}}async updateRecords(t,e){const n=Number((e/1e3).toFixed(2));try{const e=await fetch(`http://127.0.0.1:3000/winners/${t}`);if(404===e.status&&t)throw await this.createWinner(t,n),new Error("This is new winner!");const a=await e.json();this.updateWinner(a,n)}catch{console.warn("This is new winner!")}}async createWinner(t,e,n=1){try{await fetch("http://127.0.0.1:3000/winners",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({id:t,wins:n,time:e})}),this.viewContent()}catch(t){console.warn("Server is not available!")}}async updateWinner(t,e){try{await fetch(`http://127.0.0.1:3000/winners/${t.id}`,{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify({wins:t.wins+1,time:t.time>e?e:t.time})}),this.viewContent()}catch{console.warn("Server is not available!")}}}U.limitOfWinnersToPage=10;const X=U;var V=n(25),_={};_.styleTagTransform=p(),_.setAttributes=c(),_.insert=r().bind(null,"head"),_.domAPI=s(),_.insertStyleElement=d(),e()(V.A,_);const Y=V.A&&V.A.locals?V.A.locals:void 0;var tt=n(378),et={};et.styleTagTransform=p(),et.setAttributes=c(),et.insert=r().bind(null,"head"),et.domAPI=s(),et.insertStyleElement=d(),e()(tt.A,et),tt.A&&tt.A.locals&&tt.A.locals;var nt=n(245),at={};at.styleTagTransform=p(),at.setAttributes=c(),at.insert=r().bind(null,"head"),at.domAPI=s(),at.insertStyleElement=d(),e()(nt.A,at),nt.A&&nt.A.locals&&nt.A.locals,(new class{constructor(){this.garage=new F,this.winners=new X,this.btnGarage=new b("GARAGE"),this.btnWinners=new b("WINNERS"),this.page=g("div",[Y.page],{},this.btnGarage,this.btnWinners,this.garage.element,this.winners.element),this.garage.element.addEventListener("race",(t=>{this.winners.updateRecords(t.detail.id,t.detail.time)}))}toGarage(){this.btnGarage.disabled=!0,this.btnWinners.disabled=!1,this.garage.shows(),this.winners.hidde()}toWinners(){this.btnWinners.disabled=!0,this.btnGarage.disabled=!1,this.winners.shows(),this.garage.hidde(),this.winners.viewContent()}start(){this.btnGarage.addEventListener("click",(()=>this.toGarage())),this.btnWinners.addEventListener("click",(()=>this.toWinners())),this.toGarage(),document.body.append(this.page)}}).start()})()})();